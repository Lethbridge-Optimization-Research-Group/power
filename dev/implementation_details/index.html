<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Implementation Details · MPOPF Documentation</title><meta name="title" content="Implementation Details · MPOPF Documentation"/><meta property="og:title" content="Implementation Details · MPOPF Documentation"/><meta property="twitter:title" content="Implementation Details · MPOPF Documentation"/><meta name="description" content="Documentation for MPOPF Documentation."/><meta property="og:description" content="Documentation for MPOPF Documentation."/><meta property="twitter:description" content="Documentation for MPOPF Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MPOPF Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../class_diagram/">Class Diagram</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../background/">Background</a></li><li class="is-active"><a class="tocitem" href>Implementation Details</a><ul class="internal"><li><a class="tocitem" href="#Factory-Structs"><span>Factory Structs</span></a></li><li><a class="tocitem" href="#MPOPF-Model-Structs"><span>MPOPF Model Structs</span></a></li><li><a class="tocitem" href="#Create-Model-Functions"><span>Create Model Functions</span></a></li></ul></li><li><a class="tocitem" href="../linearization/">Linearization Techniques</a></li><li><a class="tocitem" href="../future_development/">Future Development</a></li><li><a class="tocitem" href="../design_philosophy/">Design Philosophy</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Implementation Details</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Implementation Details</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Maxim-Ciobanu/OPF" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Maxim-Ciobanu/OPF/blob/main/docs/src/implementation_details.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Implementation-Details"><a class="docs-heading-anchor" href="#Implementation-Details">Implementation Details</a><a id="Implementation-Details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-Details" title="Permalink"></a></h1><p>Here we will discuss how the project was built from a programming perspective.</p><h2 id="Factory-Structs"><a class="docs-heading-anchor" href="#Factory-Structs">Factory Structs</a><a id="Factory-Structs-1"></a><a class="docs-heading-anchor-permalink" href="#Factory-Structs" title="Permalink"></a></h2><p>The Factories are used as parameters so that Julia&#39;s multiple dispatch feature runs the correct functions depending on the factory given.</p><p>We have two, <code>ACMPOPFModelFactory</code> and <code>DCMPOPFModelFactory</code> which are subtypes of the abstract type <code>AbstractMPOPFModelFactory</code>. This abstract type is what the implementation functions expect but since AC and DC are subtypes they will work. This makes it possible to create functions with the same names that preform different operations depending on the factory provided.</p><p>Here is the code for our Factory Structs:</p><pre><code class="language-julia hljs"># Abstract type as a base so that we can use this type as a parameter in fucntions
abstract type AbstractMPOPFModelFactory end

# This struct &quot;inherits&quot; from PowerFlowModelFactory
mutable struct ACMPOPFModelFactory &lt;: AbstractMPOPFModelFactory
	file_path::String
	optimizer::Type

	function ACMPOPFModelFactory(file_path::String, optimizer::Type)
		return new(file_path, optimizer)
	end
end

# This struct &quot;inherits&quot; from PowerFlowModelFactory
mutable struct DCMPOPFModelFactory &lt;: AbstractMPOPFModelFactory
	file_path::String
	optimizer::Type

	function DCMPOPFModelFactory(file_path::String, optimizer::Type)
		return new(file_path, optimizer)
	end
end</code></pre><h2 id="MPOPF-Model-Structs"><a class="docs-heading-anchor" href="#MPOPF-Model-Structs">MPOPF Model Structs</a><a id="MPOPF-Model-Structs-1"></a><a class="docs-heading-anchor-permalink" href="#MPOPF-Model-Structs" title="Permalink"></a></h2><p>The MPOPF Model objects are what the <code>create_model</code> function returns. They have all the information specific to MPOPF.</p><p>Similarly to our factory structs we currently have two concrete structs of MPOPF, <code>MPOPFModel</code> and <code>MPOPFModelUncertainty</code> which are subtypes of the abstract type <code>AbstractMPOPFModel</code>. This is useful when we want both MPOPF models to be passed in a function interchangeably (That is the case for the <code>optimize_model</code> function).</p><p><code>MPOPFModel</code> has the following as variables: </p><ul><li><code>Jump Model</code></li><li><code>Data read from file</code></li><li><code>time periods</code></li><li><code>Load Factors</code></li><li><code>Ramping Cost</code></li></ul><p><code>MPOPFModelUncertainty</code> has the same variables except that it holds one more variable <code>scenarios</code> which is only relevant for Uncertainty.</p><p>Here is the code for out MPOPF Model Structs:</p><pre><code class="language-julia hljs"># Abstract type as a base so that we can use this type as a parameter in fucntions
abstract type AbstractMPOPFModel end

# The actual PowerFlowModel struct that &quot;inherits&quot; forrm AbstractPowerFlowModel
mutable struct MPOPFModel &lt;: AbstractMPOPFModel
	model::JuMP.Model
	data::Dict
	time_periods::Int64
	factors::Vector{Float64}
	ramping_cost::Int64

	function MPOPFModel(model::JuMP.Model, data::Dict, time_periods::Int64=1, factors::Vector{Float64}=[1.0], ramping_cost::Int64=0)
		return new(model, data, time_periods, factors, ramping_cost)
	end
end

# Similar PowerFlowModel object but with an additional scenrios variable for uncertainty
mutable struct MPOPFModelUncertainty &lt;: AbstractMPOPFModel
	model::JuMP.Model
	data::Dict
	scenarios::Dict
	time_periods::Int64
	factors::Vector{Float64}
	ramping_cost::Int64

	function MPOPFModelUncertainty(model::JuMP.Model, data::Dict, scenarios::Dict, time_periods::Int64=1, factors::Vector{Float64}=[1.0], ramping_cost::Int64=0)
		return new(model, data, scenarios, time_periods, factors, ramping_cost)
	end
end</code></pre><h2 id="Create-Model-Functions"><a class="docs-heading-anchor" href="#Create-Model-Functions">Create Model Functions</a><a id="Create-Model-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Create-Model-Functions" title="Permalink"></a></h2><p>At the moment we have two <code>create_model</code> functions. The first returns an <code>MPOPFModel</code> object and the second returns an <code>MPOPFModelUncertainty</code> object. The system knows which one to call depending on whether the <code>scenarios</code> variable was given.</p><p>Both share the same logic so whatever I explain about the first can be extrapolated to the second.</p><p>The <code>create_model</code> function takes in a factory of type <code>AbstractMPOPFModelFactory</code> as the first parameter. This means that both <code>ACMPOPFModelFactory</code>, <code>DCMPOPFModelFactory</code>, or any other Factory that inherits from the Abstract one is accepted. The following three parameters, <code>time_periods</code>, <code>factors</code>, and <code>ramping_cost</code> are only relevant for multiperiod so they are optional. (If not provided, the system will assume one period).</p><p>For AC and DC models, the steps of creating a model are the same. We first define the model variables, then we define the model objective function, and lastly we set the model constraints.</p><p>However, inside of these functions different things happen depending if we want AC, DC, or any other form of defining. This is why the factory is passed as a parameter inside the <code>set_model_variables!</code>, <code>set_model_objective_function!</code>, and <code>set_model_constraints!</code> functions.</p><p>Thanks to Julia&#39;s multiple dispatch feature, the correct function will be called depending on the type of the factory. Therefore, the correct variables, objective function, and constraints will be added without having to create massive if statements that check what model we want.</p><p>Here is our create model function:</p><pre><code class="language-julia hljs">function create_model(factory::AbstractMPOPFModelFactory; time_periods::Int64=1, factors::Vector{Float64}=[1.0], ramping_cost::Int64=0, model_type=undef)::MPOPFModel
    data = PowerModels.parse_file(factory.file_path)
    PowerModels.standardize_cost_terms!(data, order=2)
    PowerModels.calc_thermal_limits!(data)

    model = JuMP.Model(factory.optimizer)

    power_flow_model = MPOPFModel(model, data, time_periods, factors, ramping_cost)

    set_model_variables!(power_flow_model, factory)
    set_model_objective_function!(power_flow_model, factory)
    model_type !== undef ? set_model_constraints!(power_flow_model, factory, model_type) : set_model_constraints!(power_flow_model, factory)

    return power_flow_model
end</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <code>model_type</code> variable is only relevant for linearization and will be discussed here: <a href="../linearization/#Linearization-Techniques-for-MPOPF">Linearization Techniques for MPOPF</a></p></div></div><p>Here is an example of the AC and DC <code>set_model_variables!</code> functions. Take note of the factory type accepted.</p><p><strong>AC</strong></p><pre><code class="language-julia hljs">function set_model_variables!(power_flow_model::AbstractMPOPFModel, factory::ACMPOPFModelFactory)
# Here would be the code for AC model
# Take note of the second parameter which accepts type ACMPOPFModelFactory
end</code></pre><p><strong>DC</strong></p><pre><code class="language-julia hljs">function set_model_variables!(power_flow_model::AbstractMPOPFModel, factory::DCMPOPFModelFactory)
# Here would be the code for DC model
# Take note of the second parameter which accepts type DCMPOPFModelFactory
end</code></pre><p>The factory is not used for any computation, it is just there to let the system know which function should be called in what situation.</p><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../background/">« Background</a><a class="docs-footer-nextpage" href="../linearization/">Linearization Techniques »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 19 August 2024 17:34">Monday 19 August 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
